# -*- coding: utf-8 -*-
"""
Created on Thu Jun  2 00:34:45 2022

@author: Asus
"""

from automata.pda.dpda import DPDA
from automata.pda.npda import NPDA
from automata.tm.dtm import DTM

dtm = DTM(
    states={"q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8", "q9"},
    input_symbols={"0", "1"},
    tape_symbols={"0", "1", "#", ".", "x"},
    transitions={
        #####################################################
        "q1": {"1": ("q3", "x", "R"), "0": ("q2", "x", "R"), "#": ("q8", "#", "R")},
        #####################################################
        "q2": {"0": ("q2", "0", "R"), "1": ("q2", "1", "R"), "#": ("q4", "#", "R")},
        #####################################################
        "q3": {"0": ("q3", "0", "R"), "1": ("q3", "1", "R"), "#": ("q5", "#", "R")},
        #####################################################
        "q4": {"x": ("q4", "x", "R"), "0": ("q6", "x", "L")},
        #####################################################
        "q5": {"x": ("q5", "x", "R"), "1": ("q6", "x", "L")},
        #####################################################
        "q6": {
            "0": ("q6", "0", "L"),
            "1": ("q6", "1", "L"),
            "x": ("q6", "x", "L"),
            "#": ("q7", "#", "L"),
        },
        #####################################################
        "q7": {"x": ("q1", "x", "R"), "0": ("q7", "0", "L"), "1": ("q7", "1", "L")},
        #####################################################
        "q8": {"x": ("q8", "x", "R"), ".": ("q9", ".", "R")},
        #####################################################
    },
    initial_state="q1",
    blank_symbol=".",
    final_states={"q9"},  # ,'q10'}
)


npda1 = NPDA(
    states={"qloop", "q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8", "q9", "qfinal"},
    input_symbols={"0", "1"},
    stack_symbols={"S", "A", "B", "0", "1", "$"},
    transitions={
        #############################################
        #############################################
        #############################################
        # Se agrega S y $
        "q1": {
            "": {"$": {("qloop", ("S", "$"))}},
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 1
        "q2": {
            "": {"A": {("qloop", ("1", "A"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 2
        "q3": {
            "": {"B": {("qloop", ("0", "B"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 5
        "q4": {
            "": {"S": {("qloop", ("0", "S"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 6
        "q5": {
            "": {"S": {("qloop", ("1", "S"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Medio loop 7
        "q6": {
            "": {"A": {("q7", ("A", "A"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 7
        "q7": {
            "": {"A": {("qloop", ("1", "A"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Medio loop 8
        "q8": {
            "": {"B": {("q9", ("B", "B"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        # Fin loop 8
        "q9": {
            "": {"B": {("qloop", ("0", "B"))}},
            # --------------------------------------------
        },
        #############################################
        #############################################
        #############################################
        "qloop": {
            "": {
                # inicio loop 1,#inicio loop 2,
                "S": {
                    ("q2", "A"),
                    ("q3", "B"),
                },
                # inicio y fin loop 3,inicio loop 5, inicio loop 7
                "A": {
                    ("qloop", "0"),
                    ("q4", "S"),
                    ("q6", "A"),
                },
                # inicio y fin loop 4,inicio loop 6,inicio loop 8
                "B": {
                    ("qloop", "1"),
                    ("q5", "S"),
                    ("q8", "B"),
                },
                "$": {
                    ("qfinal", ""),
                },
            },
            "0": {
                "0": {
                    ("qloop", ""),
                },  # quitar 0's
            },
            "1": {
                "1": {
                    ("qloop", ""),
                },  # quitar 1's
            },
        },
    },
    #############################################
    #############################################
    #############################################
    initial_state="q1",
    initial_stack_symbol="$",
    final_states={"qfinal"},
)

dpda2 = DPDA(
    states={"q2", "q3", "q4", "q5"},
    input_symbols={"0", "1"},
    stack_symbols={"A", "B", "$"},
    transitions={
        #############################################3
        "q2": {"0": {"$": ("q3", ("A", "$"))}},
        #############################################3
        "q3": {
            "0": {"A": ("q3", ("A", "A"))},
            "1": {"A": ("q4", "")}
            #############################################3
        },
        "q4": {
            "1": {"A": ("q4", "")},
            "": {"$": ("q5", "")}
            #############################################3
        },
    },
    initial_state="q2",
    initial_stack_symbol="$",
    final_states={"q5"},
    acceptance_mode="final_state",
)

dtm3 = DTM(
    states={"q1", "q2", "q3", "q4", "q5", "q6", "q7", "q8", "q9"},
    input_symbols={"0", "1"},
    tape_symbols={"0", "1", "#", ".", "x"},
    transitions={
        #####################################################
        "q1": {"1": ("q3", "x", "R"), "0": ("q2", "x", "R"), "#": ("q8", "#", "R")},
        #####################################################
        "q2": {"0": ("q2", "0", "R"), "1": ("q2", "1", "R"), "#": ("q4", "#", "R")},
        #####################################################
        "q3": {"0": ("q3", "0", "R"), "1": ("q3", "1", "R"), "#": ("q5", "#", "R")},
        #####################################################
        "q4": {"x": ("q4", "x", "R"), "0": ("q6", "x", "L")},
        #####################################################
        "q5": {"x": ("q5", "x", "R"), "1": ("q6", "x", "L")},
        #####################################################
        "q6": {
            "0": ("q6", "0", "L"),
            "1": ("q6", "1", "L"),
            "x": ("q6", "x", "L"),
            "#": ("q7", "#", "L"),
        },
        #####################################################
        "q7": {"x": ("q1", "x", "R"), "0": ("q7", "0", "L"), "1": ("q7", "1", "L")},
        #####################################################
        "q8": {"x": ("q8", "x", "R"), ".": ("q9", ".", "R")},
        #####################################################
    },
    initial_state="q1",
    blank_symbol=".",
    final_states={"q9"},  # ,'q10'}
)


def input1(my_input_str):
    if npda1.accepts_input(my_input_str):
        print("cadena aceptada")
    else:
        print("cadena rechazada")
    print("")
    return "Gracias"


def input2(my_input_str):
    if dpda2.accepts_input(my_input_str):
        print("cadena aceptada")
    else:
        print("cadena rechazada")
    print("")
    return "Gracias"


def input3(my_input_str):
    if dtm3.accepts_input(my_input_str):
        print("cadena aceptada")
    else:
        print("cadena rechazada")
    print("")
    return "Gracias"


def menu():
    print("Las máquinas disponibles son las siguientes: ")
    print(
        "1)Automata de pila que reconoce el lenguaje en binario que tiene igual número de 0s y de 1s"
    )
    print("2) Automáta de pila que reconoce el lenguaje binario 0^n 1^n")
    print(
        "3)Máquina de Turing determinista de una cinta que reconoce si 2 cadenas en binario son iguales(Ingrese el input como w#v)"
    )
    print("#)Salir del programa ")
    x = input("Ingrese la máquina que desea utilizar: ")
    if x == "#":
        print("")
        print("Hasta luego, gracias por utilizar el programa")
        return ""
    y = input("Ingrese la cadena: ")
    print("")
    if x == "1":
        print(input1(y))
        menu()
    elif x == "2":
        print(input2(y))
        menu()
    elif x == "3":
        print(input3(y))
        menu()
    else:
        print("Error, ingrese un input válido")
        print("")
        menu()


menu()
